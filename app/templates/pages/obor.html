{% extends 'index.html' %}
{% block body %}

<style>
  .box {
    height: 100%;
    display: flex;
    flex-direction: column;
  }
</style>

<section class="hero is-medium is-primary">
  <div class="hero-body">
    <div class="container">
      <h1 class="title animate__animated animate__slideInRight">
        {{ df_obor['nazev'][0] }}
      </h1>
      <h2 class="subtitle animate__animated animate__slideInRight">
        {{ df_obor['zkratka'][0] }}
      </h2>
    </div>
  </div>
</section>
<progress id="progress" class="progress is-primary htmx-indicator"></progress>

<div class="container p-5">
  <div class="tile is-ancestor is-light">
    <div class="tile is-4 is-vertical is-parent">
      <div class="tile is-child box has-background-light">
        <p class="title">Přehled</p>
        <p>
          <span class="has-text-weight-bold">
            Typ studia:
          </span> {{ df_obor['typ'][0] }}
        </p>
        <p>
          <span class="has-text-weight-bold">
            Forma studia:
          </span> {{ df_obor['forma'][0] }}
        </p>
      </div>
      <div class="tile is-child box has-background-light">
        <p class="title">Garant</p>
        <p>{{ df_obor['garant'][0] }}</p>
      </div>
    </div>
    <div class="tile is-parent">
      <div class="tile is-child box has-background-light">
        <p class="title">Anotace studijního programu</p>
        <p>{{ df_obor['anotace'][0] }}</p>
      </div>
    </div>
  </div>

  <hr>

</div>



  <h2 class="is-size-1 p-3 has-text-centered">Studijní plán</h2>

  <form
  id="form"
  hx-post="/ws/filter"
  hx-indicator="#progress"
  hx-target="#table">
  <input type="hidden" name="df" value="{{ df_predmety_str }}">
  <table class="table is-hoverable mx-auto">
    <thead>
      <tr>
        {% for column in df_predmety.columns %}
        <th class="has-text-centered">
          {{ column }}
        </th>
        {% endfor %}
      </tr>
    </thead>
    <thead>
      <tr>
        <th>
          <div class="select is-primary is-rounded">
            <select name="Blok" hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">

              <option>Vše</option>
              {% for value in df_predmety["Blok"].unique() %}
              <option>{{ value }}</option>
              {% endfor %}
            </select>
          </div>
        </th>
        <th>
          <div class="select is-primary is-rounded">
            <select name="Katedra" hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">

              <option>Vše</option>
              {% for value in df_predmety["Katedra"].unique() %}
              <option>{{ value }}</option>
              {% endfor %}
            </select>
          </div>
        </th>
        <th>
          <div class="field">
            <p class="control has-icons-left">
              <input class="input is-primary is-rounded" type="text" name="Zkratka" value=""
              hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">
              <span class="icon is-medium is-left">
                <i class="mdi mdi-magnify"></i>
              </span>
            </p>
          </div>
        </th>
        <th>
          <div class="field">
            <p class="control has-icons-left">
            <input class="input is-primary is-rounded" type="text" name="Název" value=""
            hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">
            <span class="icon is-medium is-left">
                <i class="mdi mdi-magnify"></i>
              </span>
            </p>
          </div>
        </th>
        <th>
          <div class="select is-primary is-rounded">
            <select name="Garanti" hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">
              <option>Vše</option>
              {% for value in df_predmety["Garanti"].unique() %}
              <option>{{ value }}</option>
              {% endfor %}
            </select>
          </div>
        </th>
        <th>
          <div class="select is-primary is-rounded">
            <select name="Kreditů" hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">
              <option>Vše</option>
              {% for value in df_predmety["Kreditů"].unique() %}
              <option>{{ value }}</option>
              {% endfor %}
            </select>
          </div>
        </th>
        <th>
          <div class="select is-primary is-rounded">
            <select name="Rok" hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">
              <option>Vše</option>
              {% for value in df_predmety["Rok"].unique() %}
              <option>{{ value }}</option>
              {% endfor %}
            </select>
          </div>
        </th>
        <th>
          <div class="select is-primary is-rounded">
            <select name="Semestr" hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">
              <option>Vše</option>
              {% for value in df_predmety["Semestr"].unique() %}
              <option>{{ value }}</option>
              {% endfor %}
            </select>
          </div>
        </th>
      </tr>
    </thead>
    <tbody id="table">
      {% for index, row in df_predmety.iterrows() %}
      <tr _="on click go to the middle of #{{ row['Zkratka'] }}">
        {% for column in df_predmety.columns %}
        {% if column in ['Rok', 'Kreditů', 'Semestr'] %}
        <td class="has-text-centered">{{ row[column] }}</td>
        {% else %}
        <td>{{ row[column] }}</td>
        {% endif %}
        {% endfor %}
      </tr>
      {% endfor %}
    </tbody>

  </table>
</form>

<hr>

<h2 class="is-size-1 p-3 has-text-centered">Přehled předmětů</h2>

<div class="container p-5">
      {% for index, row in df_skupiny.iterrows() %}
        <div id="{{ row['zkratka'] }}" class="box p-5 animate__animated has-background-light">
          <div class="container is-max-desktop">
            <h1 class="title is-medium has-text-centered p-3">{{row['nazev']}}</h1>
            <table class="table mx-auto has-background-light">
              <tbody>
                <tr>
                  <th>Kód kurzu</th>
                  <td>{{ row['katedra'] }}/{{ row['zkratka'] }}</td>
                </tr>
                <tr>
                  <th>Počet kreditů</th>
                  <td>{{ row['kreditu'] }}</td>
                </tr>
                <tr>
                  <th>Vyučující</th>
                  <td>
                    {{ (row['prednasejici'] | string).translate({39:None}) }}
                  </td>
                </tr>
                <tr>
                  <th>Semestr</th>
                  <td>
                    {% if row['vyukaZS'] == 'A' %}
                    Zimní
                    {% else %}
                    Letní 
                    {% endif %}
                  </td>
                </tr>
        
                <tr>
                  <th>Přednášky/cvičení</th>
                  <td>
                    {{ row['jednotekPrednasek']}}/{{ row['jednotekCviceni']
                    }} HOD/TYD
                  </td>
                </tr>
                <tr>
                  <th>Zakončení</th>
                  <td>{{ row['typZkousky'] }}</td>
                </tr>
                <tr>
                  <td colspan="2">{{ row['anotace'] }}</td>
                </tr>
                <tr>
                  <td colspan="2">
                    {{ row['prehledLatky'] | replace("\n", "<br />" | safe ) }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          </div>
      {% endfor %}
</div>


{% endblock %}