{% extends 'index.html' %}
{% block body %}

<style>
  .box {
    height: 100%;
    display: flex;
    flex-direction: column;
  }
</style>

<section class="hero is-medium is-primary">
  <div class="hero-body">
    <div class="container">
      <h1 class="title animate__animated animate__slideInRight">
        {{ df_obor['nazev'][0] }}
      </h1>
      <h2 class="subtitle animate__animated animate__slideInRight">
        {{ df_obor['zkratka'][0] }}
      </h2>
    </div>
  </div>
</section>
<progress id="progress" class="progress is-primary htmx-indicator"></progress>

<div class="container p-5">
  <div class="tile is-ancestor is-light">
    <div class="tile is-4 is-vertical is-parent">
      <div class="tile is-child box has-background-light">
        <p class="title">Přehled</p>
        <p>
          <span class="has-text-weight-bold">
            Typ studia:
          </span> {{ df_obor['typ'][0] }}
        </p>
        <p>
          <span class="has-text-weight-bold">
            Forma studia:
          </span> {{ df_obor['forma'][0] }}
        </p>
      </div>
      <div class="tile is-child box has-background-light">
        <p class="title">Garant</p>
        <p>{{ df_obor['garant'][0] }}</p>
      </div>
    </div>
    <div class="tile is-parent">
      <div class="tile is-child box has-background-light">
        <p class="title">Anotace studijního programu</p>
        <p>{{ df_obor['anotace'][0] }}</p>
      </div>
    </div>
  </div>

  <hr>

  <h2 class="is-size-1 p-3 has-text-centered">Studijní plán</h2>

  <div id="table" class="container">
  <form
  id="form"
  hx-post="/ws/filter"
  hx-indicator="#progress"
  hx-target="#table"
  hx-swap="innerHTML">
  <input type="hidden" name="df" value="{{ df_predmety_str }}">
  <table class="table mx-auto is-hoverable">
    <thead>
      <tr>
        {% for column in df_predmety.columns %}
        <th>
          <div class="select is-primary">
            <select name="{{ column }}" hx-post="/ws/filter" hx-trigger="change" hx-target="#table" hx-swap="innerHTML">

              <option>{{ column }}</option>
              {% for value in df_predmety[column].unique() %}
              <option>{{ value }}</option>
              {% endfor %}
            </select>
          </div>
        </th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      {% for index, row in df_predmety.iterrows() %}
      <tr>
        {% for column in df_predmety.columns %}
        {% if column == "Název" %}
        <td>
          <a href="#{{ row['Zkratka'] }}"
          _="on click wait 0.5s then add .animate__shakeX to #{{ row['Zkratka'] }} then wait 1s then remove .animate__shakeX from #{{ row['Zkratka'] }}">
            {{ row[column] }}
          </a>
        {% else %}
        <td>{{ row[column] }}</td>
        {% endif %}
        {% endfor %}
      </tr>
      {% endfor %}
    </tbody>

  </table>
</form>
</div>

  <hr>

<h2 class="is-size-1 p-3 has-text-centered">Přehled předmětů</h2>


<div class="container p-5">
  <div class="columns is-multiline is-centered">
      {% for index, row in df_skupiny.iterrows() %}
      <div class="column is-6-tablet is-3-desktop is-8-widescreen is-6-fullhd">
        <div id="{{ row['zkratka'] }}" class="box p-5 animate__animated has-background-light">
          <div class="container is-max-desktop">
            <h1 class="title is-medium has-text-centered p-3">{{row['nazev']}}</h1>
            <table class="table mx-auto has-background-light">
              <tbody>
                <tr>
                  <th>Kód kurzu</th>
                  <td>{{ row['katedra'] }}/{{ row['zkratka'] }}</td>
                </tr>
                <tr>
                  <th>Počet kreditů</th>
                  <td>{{ row['kreditu'] }}</td>
                </tr>
                <tr>
                  <th>Vyučující</th>
                  <td>
                    {{ (row['prednasejici'] | string).translate({39:None}) }}
                  </td>
                </tr>
                <tr>
                  <th>Semestr</th>
                  <td>
                    {% if row['vyukaZS'] == 'A' %}
                    Zimní
                    {% else %}
                    Letní 
                    {% endif %}
                  </td>
                </tr>
        
                <tr>
                  <th>Přednášky/cvičení</th>
                  <td>
                    {{ row['jednotekPrednasek']}}/{{ row['jednotekCviceni']
                    }} HOD/TYD
                  </td>
                </tr>
                <tr>
                  <th>Zakončení</th>
                  <td>{{ row['typZkousky'] }}</td>
                </tr>
                <tr>
                  <td colspan="2">{{ row['anotace'] }}</td>
                </tr>
                <tr>
                  <td colspan="2">
                    {{ row['prehledLatky'] | replace("\n", "<br />" | safe ) }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          </div>
      </div>
      {% endfor %}
  </div>
</div>

</div>

{% endblock %}